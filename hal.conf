<!-- This configuration file specifies the required security policies
     for the HAL to work. -->

<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>

  <!-- ../system.conf have denied everything, so we just punch some holes -->

  <policy context="default">
    <allow own="org.freedesktop.Hal"/>

    <!-- Anyone can talk to the HAL service -->
    <allow send_to="org.freedesktop.Hal"/>
    <allow receive_from="org.freedesktop.Hal"/>

    <allow send="org.freedesktop.Hal.hald.GetDevices"/>
    <allow send="org.freedesktop.Hal.hald.GetPropertyKeys"/>
    <allow send="org.freedesktop.Hal.hald.GetProperty"/>
    <allow send="org.freedesktop.Hal.hald.GetAllProperties"/>
    <allow send="org.freedesktop.Hal.hald.EnableDevice"/>
    <allow send="org.freedesktop.Hal.hald.DisableDevice"/>
    <allow send="org.freedesktop.Hal.hald.SetProperty"/>

    <allow receive="org.freedesktop.Hal.libhal.DeviceAdded"/>
    <allow receive="org.freedesktop.Hal.libhal.DeviceRemoved"/>
    <allow receive="org.freedesktop.Hal.libhal.DeviceBooting"/>
    <allow receive="org.freedesktop.Hal.libhal.DeviceShuttingDown"/>
    <allow receive="org.freedesktop.Hal.libhal.DeviceDisabled"/>
    <allow receive="org.freedesktop.Hal.libhal.DeviceNeedDeviceInfo"/>
    <allow receive="org.freedesktop.Hal.libhal.DeviceBootError"/>
    <allow receive="org.freedesktop.Hal.libhal.DeviceEnabled"/>
    <allow receive="org.freedesktop.Hal.libhal.DeviceRequireUser"/>
    <allow receive="org.freedesktop.Hal.libhal.DevicePropertyChanged"/>

  </policy>

  <!-- Root only -->
  <policy user="root">

    <!-- For hotplug subsystem, only root can send and receive -->
    <allow send="org.freedesktop.Hal.agent.HotplugEvent"/>
    <allow receive="org.freedesktop.Hal.agent.HotplugEvent"/>

    <!-- hald only-->
    <allow receive="org.freedesktop.Hal.hald.GetDevices"/>
    <allow receive="org.freedesktop.Hal.hald.GetPropertyKeys"/>
    <allow receive="org.freedesktop.Hal.hald.GetProperty"/>
    <allow receive="org.freedesktop.Hal.hald.GetAllProperties"/>
    <allow receive="org.freedesktop.Hal.hald.EnableDevice"/>
    <allow receive="org.freedesktop.Hal.hald.DisableDevice"/>
    <allow receive="org.freedesktop.Hal.hald.SetProperty"/>

    <allow send="org.freedesktop.Hal.libhal.DeviceAdded"/>
    <allow send="org.freedesktop.Hal.libhal.DeviceRemoved"/>
    <allow send="org.freedesktop.Hal.libhal.DeviceBooting"/>
    <allow send="org.freedesktop.Hal.libhal.DeviceShuttingDown"/>
    <allow send="org.freedesktop.Hal.libhal.DeviceDisabled"/>
    <allow send="org.freedesktop.Hal.libhal.DeviceNeedDeviceInfo"/>
    <allow send="org.freedesktop.Hal.libhal.DeviceBootError"/>
    <allow send="org.freedesktop.Hal.libhal.DeviceEnabled"/>
    <allow send="org.freedesktop.Hal.libhal.DeviceRequireUser"/>
    <allow send="org.freedesktop.Hal.libhal.DevicePropertyChanged"/>
  </policy>

</busconfig>
